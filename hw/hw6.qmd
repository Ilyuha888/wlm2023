# HW6 // Случайный эксперимент. Случайные величины {#hw6 .unnumbered}

```{=html}
<!--
REPLACE ALL hw6 TO hw<n> WITH MATCH CASE
-->
```

```{r opts, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = FALSE, message = FALSE, warning = FALSE)
```

```{r pkgs, eval=TRUE}
library(tidyverse)
theme_set(theme_bw())
```

{{< include ../book/_symbols.qmd >}}

## Основные задания {#hw6_main}

### #1 {#hw6-1-title}

<img id="hw6-1-level" class="level"/>

::: {#hw6-1-task .task}

По [ссылке](https://github.com/angelgardt/wlm2023/raw/master/data/hw6/dice.RData) расположен файл `.RData` с симуляцией трёх восьмигранных игральный кубиков `dice1`, `dice2` и `dice3`. Один из них является честным, другой --- нечестным, а третий --- невозможным.

Выясните, какой именно каким является.

Симуляции представляют собой функции, которые принимают на вход число бросаний кубика `n` и возвращают вектор длины `n` с исходами бросаний кубиков.

::: {.callout-tip}

#### Загрузить файл `.RData`

Для загрузки симуляций в окружение воспользуйтесь следующим кодом:

```{r load-url, echo=TRUE}
load(url("link/to/file"))
```

:::

:::

```{r hw6-1-dice}
# rm(list = ls())

dice1 <- function(n) {
  v <- sample(0:8, n, replace = TRUE, prob = c(30, 20, rep(5, 6), 20))
  return(v[v != 0])
}
dice2 <- function(n) {
  sample(1:8, n, replace = TRUE)
}
dice3 <- function(n) {
  sample(1:8, n, replace = TRUE, prob = c(4, rep(12, 6), 4))
}
save.image("../data/hw6/dice.RData")
rm(list = ls())
```

```{r hw6-1}
load(url("https://github.com/angelgardt/wlm2023/raw/master/data/hw6/dice.RData"))

dice1(10000) %>% table() %>% `/`(10000) #%>% sum()
dice2(10000) %>% table() %>% `/`(10000) #%>% sum()
dice3(10000) %>% table() %>% `/`(10000) #%>% sum()
```

::: {#hw6-1-autocheck .autocheck}
::: {#hw6-1-ir .input-requirements}
В качестве ответа для самопроверки введите через запятую номера кубиков в следующем порядке --- _честный, нечестный, невозможный_. Формат ввода `1,2,3`. Проверка игнорирует все пробелы.
:::

<input class="autocheck-input" type="text" id="hw6-1" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-1')">

::: {#hw6-1-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-1-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

* Загрузите файл `.RData` с помощью кода из задания --- в окружении должны отобразиться три функции `dice1`, `dice2` и `dice3`.
* Используя классический подход к вероятности, рассчитайте ожидаемые вероятности, с которыми будут выпадать значения при бросании честного игрального кубика.
* Используя статистический подход к вероятности, рассчитайте наблюдаемые вероятности, с которыми выпадают значения при бросании каждого из трех игральных кубиков.
* Сопоставьте результаты и определите, какой кубик является честным, какой --- нечестным, а какой --- невозможным.

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

* Загрузить файл с симуляциями с помощью кода `load(url("https://github.com/angelgardt/wlm2023/raw/master/data/hw6/dice.RData"))`
* Считая, что честный кубик тот, на котором выпадение каждого числа очков равновероятно, рассчитайте ожидаемые вероятности выпадения каждой грани для восьмигранного кубика.
* Используя загруженные функции, проведите достаточно большое количество испытаний каждого кубика --- пример использования функции для 100 бросаний первого кубика: `dice1(100)`.
* Постройте таблицу наблюдаемых частот для каждого кубика и проверьте, совпадают ли полученные результаты с рассчетом классической вероятности.

</details>

<details class="hint">

<summary>Ответ неверный</summary>

* Проверьте, что вы ввели тольно номера кубиков, то есть ваш ответ соответствует формату `1,2,3`, а не `dice1,dice2,dice3`
* Проверьте, что вы провели достаточное количество испытаний, чтобы получить точные оценки вероятностей.

</details>

</details>
:::

### #2 {#hw6-2-title}

<img id="hw6-2-level" class="level"/>

::: {#hw6-2-task .task}
Рассчитайте математическое ожидание случайной величины, имеющей следующую функцию вероятности:

|$x$|$0$|$2$|$3$|$6$|
|:---|:---|:---|:---|:---|
|$\prob(X=x)$|$0.3$|$0.4$|$0.2$|$0.1$|

[Отсюда](https://raw.githubusercontent.com/angelgardt/wlm2023/master/data/hw6/task2.csv) можно скачать таблицу в формате CSV.

:::

```{r hw6-2-table}
tibble(x = c(0, 2, 3, 6),
       p = c(0.3, 0.4, 0.2, 0.1)) %>% 
  write_csv("../data/hw6/task2.csv")
```

```{r hw6-2}
task2 <- read_csv("https://raw.githubusercontent.com/angelgardt/wlm2023/master/data/hw6/task2.csv")
(task2$x * task2$p) %>% sum()
```

::: {#hw6-2-autocheck .autocheck}
::: {#hw6-2-ir .input-requirements}

В качестве ответа для самопроверки введите получившееся значение математического ожидания.

:::

<input class="autocheck-input" type="text" id="hw6-2" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-2')">

::: {#hw6-2-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-2-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

* Загрузите таблицу, задающую функцию вероятности случайной величины.
* В таблице есть две колонки: `x` --- значение случайной величины, `p` --- вероятность, с которой случайная величина принимает данное значение.
* Используя формулу математического ожидания для дискретной случайной величины, рассчитайте математическое ожидание данной случайной величины.

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

* Загрузить таблицу, задающую функцию вероятности случайной величины, с помощью функции `read_csv()` или `read.csv()`.
* В таблице есть две колонки: `x` --- значение случайной величины, `p` --- вероятность, с которой случайная величина принимает данное значение.
* Математическое ожидание дискретной случайной величины определяется следующим образом:

$$
\expect(X) = \sum_{i=1}^{n} x_ip_i
$$
* Используя эту формулу и знания о работе с датафреймами, вычислите математическое ожидание.

</details>

<details class="hint">

<summary>Ответ неверный</summary>

* Проверьте рассчеты --- в результате вычислений должно получатся целое число.

</details>

</details>
:::

### #3 {#hw6-3-title}

<img id="hw6-3-level" class="level"/>

::: {#hw6-3-task .task}

Для случайной величины [из предыдущего задания](#hw6-2-title) рассчитайте её дисперсию.

:::

```{r hw6-3}
task2$x2 <- task2$x^2
((task2$x2 * task2$p) %>% sum()) - ((task2$x * task2$p) %>% sum())^2
```

::: {#hw6-3-autocheck .autocheck}
::: {#hw6-3-ir .input-requirements}
В качестве ответа для самопроверки введите получившееся значение дисперсии.
:::

<input class="autocheck-input" type="text" id="hw6-3" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-3')">

::: {#hw6-3-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-3-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

* Добавьте в загруженную таблицу новую колонку, необходимую для расчета дисперсии.
* Используя формулу дисперсии для дискретной случайной величины, рассчитайте дисперсию данной случайной величины.

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

* Дисперсия случайной величины определяется следующим образом:

$$
\var(X) = \expect(X^2) - \big(\expect(X)\big)^2
$$

* Необходимо рассчитать значения квадрата случайной величины на основе данных в загруженной таблицы значений `x`
* Используя вероятности `p` и значения из добавленной колонки, рассчитать математическое ожидание квадрата случайной величины.
* По формуле дисперсии случайной величины рассчитать дисперсию данной случайной величины.

</details>

<details class="hint">

<summary>Ответ неверный</summary>

* Проверьте рассчеты --- в результате вычислений должно получатся целое число.

</details>

</details>
:::

### #4 {#hw6-4-title}

<img id="hw6-4-level" class="level"/>

::: {#hw6-4-task .task}

Данные некоторого эксперимента собираются на трёх различных компьютерах, никак не взаимодействующих друг с другом. Вероятность того, что при записи данных на первом компьютере случится ошибка равна 0.2, на втором --- 0.1, на третьем --- 0.15. 

a. Какова вероятность, что при обработке всех данных эксперимента будут обнаружены битые (содержащие ошибки записи) данные со всех трех компьютеров?
b. В течение сбора данных эксперимента еа первом компьютере было записано 30 файлов, на втором --- 20, на третьем --- 35. Сколько битых (содержащих ошибки записи) файлов ожидается к моменту обработки данных?

Считайте, что наличие ошибок записи зависит только от компьютера, на котором проводится эксперимент. Обработка данных начинается после сбора всех данных эксперимента.

:::

```{r hw6-4}
## a
0.2 * 0.1 * 0.15

## b
(30 * 0.2 + 20 * 0.1 + 32 * 0.15) %>% round()
```

::: {#hw6-4-autocheck .autocheck}
::: {#hw6-4-ir .input-requirements}
Для самопроверки в поле ответа введите два числа, разделенные запятой. Первое число --- ответ на пункт _а_, округленный _до тысячных_, второе --- ответ на пункт _b_, округленный _до целого_.  В качестве десятичного разделителя используйте точку.
:::

<input class="autocheck-input" type="text" id="hw6-4" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-4')">

::: {#hw6-4-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-4-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #5 {#hw6-5-title}

<img id="hw6-5-level" class="level"/>

::: {#hw6-5-task .task}

Три психолога независимо друг от друга выполняют тестовое задание на позицию продуктового аналитика. У них разная степерь прошаренности в статистике, поэтому вероятности того, что они выполят тестовое задание правильно равны 0.8, 0.7 и 0.6 соответственно.

a. Какова вероятность, что никто из кандидатов не выполнит правильно тестовое задание?
b. Какова вероятность, что хотя бы один из кандидатов выполнит правильно тестовое задание?

:::

```{r hw6-5}
## a
(1 - .8) * (1-.7) * (1-.6)
## b
1 - ((1 - .8) * (1-.7) * (1-.6))
```

::: {#hw6-5-autocheck .autocheck}
::: {#hw6-5-ir .input-requirements}

Для самопроверки в поле ответа введите два числа, разделенные запятой. Первое число --- ответ на пункт _а_, второе --- ответ на пункт _b_. Оба значения округлите _до тысячных_.  В качестве десятичного разделителя используйте точку.

:::

<input class="autocheck-input" type="text" id="hw6-5" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-5')">

::: {#hw6-5-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-5-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #6 {#hw6-6-title}

<img id="hw6-6-level" class="level"/>

::: {#hw6-6-task .task}

На специальности 37.03.01 «Психология» в бакалавриате некоего вуза учится 1500 студентов: 520 на первом курсе, 480 на втором и 315 на третьем. Вероятности того, что студент первого, второго, третьего и четвертого курса получил при освоении курса статистики «отлично», равны соответствено 0.6, 0.8, 0.7 и 0.65. В курилке мы случайным образом завели беседу с одним из студентов-психологов. Какова вероятность, что у него в зачетке «отлично» по статистике?

:::

```{r hw6-6}
course1 = 520/1500
course2 = 480/1500
course3 = 315/1500
course4 = (1500-520-480-315)/1500

0.6 * course1 + 0.8 * course2 + 0.7 * course3 + 0.65 * course4
```

::: {#hw6-6-autocheck .autocheck}
::: {#hw6-6-ir .input-requirements}
Для самопроверки в поле ответа введите получившееся значение, округленное _до тысячных_.  В качестве десятичного разделителя используйте точку.
:::

<input class="autocheck-input" type="text" id="hw6-6" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-6')">

::: {#hw6-6-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-6-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #7 {#hw6-7-title}

<img id="hw6-7-level" class="level"/>

::: {#hw6-7-task .task}

Российский ПЦР-тест на COVID-19 SARS-CoV-2, с помощью которого проводится экспресс-анализ для выявления коронавирусной инфекции, обладает 98% чувствительностью и 98% специфичностью. Будем считать, что в России проживает [согласно грубым оценкам] 146 700 000 человек, из которых в среднем 1 550 000 заражено COVID-19. Вы сдали тест SARS-CoV-2 на коронавирус, который показал положительный результат. Какова вероятность, что вы действительно заражены коронавирусной инфекцией?

::: {.callout-note}

#### Чувствительность и специфичность

* Чувствительность клинического теста показывает вероятность того, что больной субъект будет идентифицирован как больной.
* Специфичность клинического теста показывает вероятность того, что здоровый субъект будет идентифицирован как здоровый. 

Подробнее можно почитать [тут](https://en.wikipedia.org/wiki/Sensitivity_and_specificity).

:::

:::


::: {#hw6-7-autocheck .autocheck}
::: {#hw6-7-ir .input-requirements}

Для самопроверки в поле ответа введите получившееся значение, округленное _до сотых_. В качестве десятичного разделителя используйте точку.

:::

<input class="autocheck-input" type="text" id="hw6-7" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-7')">

::: {#hw6-7-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-7-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #8 {#hw6-8-title}

<img id="hw6-8-level" class="level"/>

::: {#hw6-8-task .task}

Какова вероятность, что сотрудник случайно пройдет квалификационный тест, который включает в себя 30 тестовых вопросов с пятью вариантами ответа, если в каждом вопросе только один правильный ответ, а для прохождения теста необходимо набрать минимум 25 правильных ответов?

:::

::: {#hw6-8-autocheck .autocheck}
::: {#hw6-8-ir .input-requirements}

Для самопроверки в поле ответа введите получившееся значение в научном формате записи числа (scientific notation).

Пример, как выглядит научный формат в жизни: $2.3\times10^{-12}$. 

Пример, как это число вводить в поле ответа: `2.3*10^-12`.

Мантиссу (число слева от знака умножения) округлите до сотых. В качестве десятичного разделителя используйте точку. Подробнее о научном формате записи чисел [тут](https://ru.wikipedia.org/wiki/Экспоненциальная_запись).

:::

<input class="autocheck-input" type="text" id="hw6-8" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-8')">

::: {#hw6-8-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-8-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #9 {#hw6-9-title}

<img id="hw6-9-level" class="level"/>

::: {#hw6-9-task .task}

Известно, что время реакции ($X$, секунды) в некотором эксперименте подчиняется следующему распределению:

```{r hw6-9-plot, eval=TRUE}
tibble(x = seq(0, 30, by = .001),
       y = dgamma(x, shape = 2, rate = 1)) %>% 
  ggplot(aes(x, y)) +
  geom_line() +
  labs(x = "X", y = "Density")
```

Это гамма-распределение (`dgamma()`) с параметрами `shape = 2` и `rate = 1`.

a. Найдите вероятность, что время реакции в случайной пробе будет равно 8.28 секунды.
b. Найдите вероятность, что время реакции в случайной пробе будет находится в пределах от 2 до 6 секунд.

```{r hw6-9}
## a
### 0, rt is a continuous rand var

## b
integrate(dgamma, 2, 6, shape = 2, rate = 1)
```

:::

::: {#hw6-9-autocheck .autocheck}
::: {#hw6-9-ir .input-requirements}
Для самопроверки в поле ответа введите два числа, разделенные запятой. Первое число --- ответ на пункт _а_, второе --- ответ на пункт _b_. Оба значения округлите _до сотых_.  В качестве десятичного разделителя используйте точку.

_Если в ответе получается целое число, то введите его в формате `2.00`._

:::

<input class="autocheck-input" type="text" id="hw6-9" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-9')">

::: {#hw6-9-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-9-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::

### #10 {#hw6-10-title}

<img id="hw6-10-level" class="level"/>

::: {#hw6-10-task .task}

Визуализируйте функцию плотности вероятности нормального распределения с параметрами $\mu = 8.2$ и $\sigma^2 = 37.21$.

:::

::: {#hw6-10-autocheck .autocheck}
::: {#hw6-10-ir .input-requirements}
Описание формата инпута.
:::

<input class="autocheck-input" type="text" id="hw6-10" placeholder="Введите ответ…">

<input class="autocheck-button" type="button" value="Проверить" onclick="check('hw6-10')">

::: {#hw6-10-fb .autocheck-feedback}
:::
:::

::: hints-wrapper
<details class="hints" id="hw6-10-hints">

<summary>Подсказки</summary>

<details class="hint">

<summary>Как делать задание?</summary>

</details>

<details class="hint">

<summary>Что надо сделать?</summary>

</details>

<details class="hint">

<summary>Ответ неверный</summary>

</details>

</details>
:::



```{=html}
<!--- CHANGE hw6 TO hw<n> IN THE LINES BELOW--->
<script type="text/javascript" src="./js/hw6.json"></script>
<script type="text/javascript" src="./js/hw.js"></script>
```
