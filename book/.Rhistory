ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_leftskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_leftskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = 0.845, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = .9, y = 1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .8, y = 1) +
labs(x = "Value", y = "")
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_rightskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_rightskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 1.25, y = .2) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .5, y = .2) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
median_bimodal_data_build |>
ggplot(aes(x, y)) +
geom_histogram(data = median_bimodal_data,
aes(x = x, y = after_stat(density)),
fill = "gray90", binwidth = .4) +
geom_line() +
geom_polygon(data = median_bimodal_data_build_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_bimodal_data_build_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = m, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 2.25, y = .1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = 1.25, y = .1) +
labs(x = "Value", y = "Density")
setwd("~/wlm2023/pics-dev")
library(tidyverse)
theme_set(theme_bw())
set.seed(123)
rnorm(10^6, mean = 300, sd = 100) -> pop
hist(pop)
ggplot(NULL) +
geom_histogram(aes(x = pop))
ggplot(NULL) +
geom_histogram(aes(x = pop), color = "gray50")
ggplot(NULL) +
geom_histogram(aes(x = pop), fill = "gray50")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 10,
fill = "gray50")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 30,
fill = "gray50")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300, color = "darkred")
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300, color = "darkred") +
scale_x_continuous(breaks = seq(0, 750, by = 100))
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300, color = "darkred") +
scale_x_continuous(breaks = seq(-200, 850, by = 100))
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300, color = "darkred") +
scale_x_continuous(breaks = seq(-200, 800, by = 100))
var_pop <- function (x) { sum((x - mean(x))^2) / length(x) }
mad <- function (x) { sum(abs(x - mean(x))) / length(x)} # mean absolute deviation
set.seed(567)
size <- 200 # sample size
n <-  1000 # num of samples
sim <- matrix(sample(pop, size * n), size)
sim
means <- sapply(sim, mean) |> unlist()
ggplot(NULL) +
geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means)) +
geom_vline(xintercept = 300, color = "darkred")
ggplot(NULL) +
geom_histogram(aes(x = means)) +
#geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means)) +
geom_vline(xintercept = 300, color = "darkred")
ggplot(NULL) +
geom_histogram(aes(x = means)) +
#geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means)) +
geom_vline(xintercept = 300, color = "darkred", linetype = "dashed")
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means)) +
geom_vline(xintercept = 300, color = "darkred", linetype = "dashed")
geom_vline(xintercept = 300+
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300) +
scale_x_continuous(breaks = seq(-200, 800, by = 100))
ggplot(NULL) +
geom_histogram(aes(x = pop),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 300) +
scale_x_continuous(breaks = seq(-200, 800, by = 100))
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means)) +
geom_vline(xintercept = 300, color = "darkred", linetype = "dashed")
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed") +
geom_vline(xintercept = 300)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
vars <- sapply(sim, var) |> unlist() # n-1
vars_pop <- sapply(sim, var_pop) |> unlist() # n
ggplot(NULL) +
geom_density(aes(x = vars)) +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
sapply(sim, var)
sapply(sim, var)
vars
sapply(sim, mean)
means <- sapply(sim, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
vars <- sapply(sim, var) # n-1
vars
means
means <- apply(sim, 2, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 15,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 5,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
vars <- apply(sim, 2, var) # n-1
vars_pop <- apply(sim, 2, var_pop) # n
ggplot(NULL) +
geom_density(aes(x = vars)) +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 1,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 10,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 15,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 30,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)
library(plotly)
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2) |>
ggplotly()
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2) +
ggplotly()
ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2) |>
ggplotly()
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)) |>
ggplotly()
set.seed(567)
size <- 100 # sample size
n <-  1000 # num of samples
sim <- matrix(sample(pop, size * n), size)
means <- apply(sim, 2, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
vars <- apply(sim, 2, var) # n-1
vars_pop <- apply(sim, 2, var_pop) # n
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = mean(vars), color = "darkred") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
geom_vline(xintercept = 100^2)) |>
ggplotly()
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 100^2)) +
geom_vline(xintercept = mean(vars), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen") +
ggplotly()
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 100^2) +
geom_vline(xintercept = mean(vars), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen")) |>
ggplotly()
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
set.seed(567)
size <- 100 # sample size
n <-  10000 # num of samples
sim <- matrix(sample(pop, size * n), size)
means <- apply(sim, 2, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
set.seed(567)
size <- 100 # sample size
n <-  1500 # num of samples
sim <- matrix(sample(pop, size * n), size)
means <- apply(sim, 2, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
set.seed(567)
size <- 100 # sample size
n <-  2000 # num of samples
sim <- matrix(sample(pop, size * n), size)
means <- apply(sim, 2, mean)
ggplot(NULL) +
geom_histogram(aes(x = means),
binwidth = 1,
fill = "gray50",
color = "gray30") +
#geom_density(aes(x = means)) +
geom_vline(xintercept = 300) +
geom_vline(xintercept = mean(means),
color = "darkred", linetype = "dashed")
vars <- apply(sim, 2, var) # n-1
vars_pop <- apply(sim, 2, var_pop) # n
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 100,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 100^2) +
geom_vline(xintercept = mean(vars), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen")) |>
ggplotly()
(ggplot(NULL) +
# geom_density(aes(x = vars)) +
geom_histogram(aes(x = vars),
binwidth = 150,
fill = "gray50",
color = "gray30") +
geom_vline(xintercept = 100^2) +
geom_vline(xintercept = mean(vars), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(vars_pop), color = "darkgreen")) |>
ggplotly()
geom_vline(xintercept = mean(sqrt(vars)), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(sqrt(vars_pop)), color = "darkgreen") +
sim2 <- list()
ggplot(NULL) +
geom_density(aes(x = sqrt(vars))) +
geom_vline(xintercept = 100) +
geom_vline(xintercept = mean(sqrt(vars)), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(sqrt(vars_pop)), color = "darkgreen")
ggplot(NULL) +
geom_histogram(aes(x = sqrt(vars)),
binwidth = 150,
fill = "gray50",
color = "gray30") +
# geom_density(aes(x = sqrt(vars))) +
geom_vline(xintercept = 100) +
geom_vline(xintercept = mean(sqrt(vars)), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(sqrt(vars_pop)), color = "darkgreen")
ggplot(NULL) +
geom_histogram(aes(x = sqrt(vars)),
binwidth = 10,
fill = "gray50",
color = "gray30") +
# geom_density(aes(x = sqrt(vars))) +
geom_vline(xintercept = 100) +
geom_vline(xintercept = mean(sqrt(vars)), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(sqrt(vars_pop)), color = "darkgreen")
ggplot(NULL) +
geom_histogram(aes(x = sqrt(vars)),
binwidth = 1,
fill = "gray50",
color = "gray30") +
# geom_density(aes(x = sqrt(vars))) +
geom_vline(xintercept = 100) +
geom_vline(xintercept = mean(sqrt(vars)), color = "darkred", linetype = "dashed") +
geom_vline(xintercept = mean(sqrt(vars_pop)), color = "darkgreen")
3:200 |> map(function(x) {matrix(sample(pop, x * n), x)})
sim2 <- 3:200 |> map(function(x) {matrix(sample(pop, x * n), x)})
n = 100
sim2 <- 3:200 |> map(function(x) {matrix(sample(pop, x * n), x)})
str(sim2)
map(sim2, apply, MARGIN = 2, FUN = length)
sim2_agg <- tibble(n = map(sim2, apply, MARGIN = 2, FUN = length) |> unlist(),
mean = map(sim2, apply, MARGIN = 2, FUN = mean) |> unlist(),
var = map(sim2, apply, MARGIN = 2, FUN = var) |> unlist(),
var_pop = map(sim2, apply, MARGIN = 2, FUN = var_pop) |> unlist(),
sd = map(sim2, apply, MARGIN = 2, FUN = sd) |> unlist(),
sd_pop = map(sim2, apply, MARGIN = 2, FUN = function(x) sqrt(var_pop(x))) |> unlist(),
mad = map(sim2, apply, MARGIN = 2, FUN = mad) |> unlist())
sim2_agg |>
ggplot(aes(n, mean)) +
geom_point(alpha = .3, color = "gray") +
geom_hline(yintercept = 300, color = "red") +
geom_smooth()
sim2_agg |>
ggplot(aes(n, mean)) +
geom_point(alpha = .3, color = "gray") +
geom_hline(yintercept = 300, color = "red") +
# geom_smooth() +
labs(x = "Sample size", y = "Means")
sim2_agg |>
ggplot(aes(n, var)) +
geom_point(alpha = .3, color = "gray") +
geom_hline(yintercept = 100^2, color = "red") +
# geom_smooth() +
labs(x = "Sample size", y = "Variances")
sim2_agg |>
ggplot(aes(n, var_pop)) +
geom_point(alpha = .3, color = "gray") +
geom_hline(yintercept = 100^2, color = "red") +
geom_smooth(color = "black") +
labs(x = "Sample size", y = "Variances")
