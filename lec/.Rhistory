.) -> median_rightskew_data_upper
median_rightskew_data |>
filter(x <= .85) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(.85, min(median_rightskew_data$x))),
.) -> median_rightskew_data_lower
# DescTools::AUC(median_rightskew_data_lower$x,
#               median_rightskew_data_lower$y)
median_rightskew_data |>
ggplot(aes(x, y)) +
geom_line() +
geom_polygon(data = median_rightskew_data_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_rightskew_data_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 1.25, y = .2) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = .5, y = .2) +
geom_vline(xintercept = 0.85, linetype = "dashed") +
labs(x = "Value", y = "Density")
#| label: fig-median-bimodal
#| fig-cap: Медиана бимодального распределения.
set.seed(115)
tibble(x = c(rnorm(80, 1.5, 0.4), rnorm(40, 4, 0.5))) -> median_bimodal_data
median_bimodal_data |>
ggplot(aes(x)) +
geom_density() -> g
ggplot_build(g) -> b
b$data[[1]] -> median_bimodal_data_build
median_bimodal_data$x |> median() -> m
# median_bimodal_data_build$x |> median() -> m
median_bimodal_data_build |>
select(y, x) |>
filter(x >= m) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(max(median_bimodal_data_build$x), m)),
.) -> median_bimodal_data_build_upper
median_bimodal_data_build |>
select(y, x) |>
filter(x <= m) %>%
bind_rows(
tibble(y = c(0, 0),
x = c(m , min(median_bimodal_data_build$x))),
.) -> median_bimodal_data_build_lower
# DescTools::AUC(x = median_bimodal_data_build_upper$x,
#                y = median_bimodal_data_build_upper$y)
# DescTools::AUC(x = median_bimodal_data_build_lower$x,
#                y = median_bimodal_data_build_lower$y)
median_bimodal_data_build |>
ggplot(aes(x, y)) +
geom_histogram(data = median_bimodal_data,
aes(x = x, y = after_stat(density)),
fill = "gray90", binwidth = .4) +
geom_line() +
geom_polygon(data = median_bimodal_data_build_lower,
aes(x = x, y = y), fill = "royalblue", alpha = .5) +
geom_polygon(data = median_bimodal_data_build_upper,
aes(x = x, y = y), fill = "seagreen", alpha = .5) +
geom_vline(xintercept = m, linetype = "dashed") +
annotate(geom = "text", label = "50%",
color = "darkgreen", x = 2.25, y = .1) +
annotate(geom = "text", label = "50%",
color = "darkblue", x = 1.25, y = .1) +
labs(x = "Value", y = "Density")
smpl1 <- tibble(x1 = seq(-3, 3, by = .001),
y1 = dnorm(x1),
x2 = x1 + 2,
y2 = dnorm(x2, mean = 2))
smpl1 %>%
ggplot() +
geom_line(aes(x1, y1), color = "blue4") +
geom_line(aes(x2, y2), color = "red4") +
geom_vline(xintercept = 0, linetype = "dashed", color = "blue4") +
geom_vline(xintercept = 2, linetype = "dashed", color = "red4") +
labs(x = "Value", y = "Density")
smpl2 <- tibble(x1 = seq(-2, 4, by = .001),
y1 = dnorm(x1, mean = 1),
x2 = x1 * 3,
y2 = dnorm(x2, mean = 3, sd = 3))
smpl2 %>%
ggplot() +
geom_line(aes(x1, y1), color = "blue4") +
geom_line(aes(x2, y2), color = "red4") +
geom_vline(xintercept = 1, linetype = "dashed", color = "blue4") +
geom_vline(xintercept = 3, linetype = "dashed", color = "red4") +
labs(x = "Value", y = "Density")
poly_left <- smpl1 %>%
select(x1, y1) %>%
filter(x1 < 0) %>%
bind_rows(tibble(x1 = c(0, -3), y1 = c(0, 0)))
poly_right <- smpl1 %>%
select(x1, y1) %>%
filter(x1 > 0) %>%
bind_rows(tibble(x1 = c(3, 0), y1 = c(0, 0)))
smpl1 %>%
ggplot() +
geom_line(aes(x1, y1)) +
geom_polygon(data = poly_left, aes(x=x1, y=y1), fill="red4", alpha = .5) +
geom_polygon(data = poly_right, aes(x=x1, y=y1), fill="green4", alpha = .5) +
geom_vline(xintercept = 0, linetype = "dashed") +
annotate(geom="text", x = -1, y = .05, label ="отрицательные\nотклонения") +
annotate(geom="text", x = 1, y = .05, label ="положительные\nотклонения") +
labs(x = "Value", y = "Density")
set.seed(108)
symm <- sample(
x = seq(1, 10, 0.5),
size = 600,
replace = TRUE,
prob = c(
.05,
.05,
.07,
.1,
.1,
.15,
.20,
.30,
.35,
.5,
.35,
.30,
.20,
.15,
.1,
.1,
.07,
.05,
.05
)
)
asymm_right <- sample(
x = seq(1, 10, 0.5),
size = 600,
replace = TRUE,
prob = c(
.1,
.2,
.25,
.4,
.5,
.5,
.4,
.35,
.3,
.25,
.2,
.25,
.2,
.15,
.1,
.1,
.07,
.05,
.05
)
)
asymm_left <- sample(
x = seq(1, 10, 0.5),
size = 600,
replace = TRUE,
prob = c(
.03,
.05,
.07,
.1,
.15,
.15,
.2,
.2,
.25,
.25,
.3,
.35,
.5,
.5,
.4,
.4,
.25,
.2,
.2
)
)
bimodal <- sample(
x = seq(1, 10, 0.5),
size = 600,
replace = TRUE,
prob = c(
.05,
.05,
.07,
.1,
.1,
.2,
.3,
.35,
.3,
.15,
.1,
.15,
.20,
.40,
.50,
.25,
.1,
.05,
.05
)
)
colors <- c("Mean" = "red4", "Median" = "blue4", "Mode" = "green4")
ggplot(NULL, aes(symm)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(symm), color = colors['Mean']) +
geom_vline(xintercept = median(symm), color = colors['Median']) +
geom_vline(xintercept = mode(symm)-0.04, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(symm)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(symm), color = colors['Mean']) +
geom_vline(xintercept = median(symm), color = colors['Median']) +
geom_vline(xintercept = mode(symm)-0.04, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(symm)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(symm), color = colors['Mean']) +
geom_vline(xintercept = median(symm), color = colors['Median']) +
geom_vline(xintercept = median(symm)-0.04, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(symm)) +
geom_histogram(aes(y = after_stat(density)), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(symm), color = colors['Mean']) +
geom_vline(xintercept = median(symm), color = colors['Median']) +
geom_vline(xintercept = median(symm)-0.04, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(asymm_right)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(asymm_right), color = colors['Mean']) +
geom_vline(xintercept = median(asymm_right), color = colors['Median']) +
# geom_vline(xintercept = , color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(asymm_right)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(asymm_right), color = colors['Mean']) +
geom_vline(xintercept = median(asymm_right), color = colors['Median']) +
geom_vline(xintercept = 2.6, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(asymm_right)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(asymm_right), color = colors['Mean']) +
geom_vline(xintercept = median(asymm_right), color = colors['Median']) +
geom_vline(xintercept = 2.65, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(asymm_right)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(asymm_right), color = colors['Mean']) +
geom_vline(xintercept = median(asymm_right), color = colors['Median']) +
geom_vline(xintercept = 3, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(asymm_left)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(asymm_left), color = colors['Mean']) +
geom_vline(xintercept = median(asymm_left), color = colors['Median']) +
geom_vline(xintercept = 7.4, color = colors['Mode']) +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(bimodal)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(bimodal), color = 'red4') +
geom_vline(xintercept = median(bimodal), color = 'blue4') +
geom_vline(xintercept = 7.6, color = 'green4') +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(bimodal)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(bimodal), color = 'red4') +
geom_vline(xintercept = median(bimodal), color = 'blue4') +
geom_vline(xintercept = 8, color = 'green4') +
labs(x = 'Value',
y = 'Density')
ggplot(NULL, aes(bimodal)) +
geom_histogram(aes(y = ..density..), alpha =.5, binwidth = .5) +
geom_density() +
geom_vline(xintercept = mean(bimodal), color = 'red4') +
geom_vline(xintercept = median(bimodal), color = 'blue4') +
geom_vline(xintercept = 7.8, color = 'green4') +
labs(x = 'Value',
y = 'Density')
corrplot::corrplot(
cor(mtcars),
type = "upper",
p.mat = corrplot::cor.mtest(mtcars)$p,
sig.level = 0.01
)
median_norm_data %>%
ggplot(aes(x, y))
median_norm_data
median_norm_data %>%
ggplot(aes(x, y))+
geom_line()
gridExtra::grid.arrange(
median_norm_data %>%
ggplot(aes(x, y))+
geom_line(),
median_leftskew_data %>%
ggplot(aes(x, y))+
geom_line(),
median_rightskew_data %>%
ggplot(aes(x, y))+
geom_line()
)
median_leftskew_data %>%
ggplot(aes(x, y))+
geom_line()
rnorm(100)
install.packages("psych")
rnorm(100) %>% psych::kurtosis()
rnorm(100) %>% psych::kurtosi()
rnorm(10000) %>% psych::kurtosi()
rnorm(10000000) %>% psych::kurtosi()
rnorm(10000000) %>% psych::skew()
# ggplot(data = )
rnorm(100000, sd = 20) %>% psych::kurtosi()
# ggplot(data = )
rnorm(100000, sd = 20) %>% hist()
tibble(x = rnorm(100000, sd = 20)) %>%
filter(x > -20 & x < 20) %>%
pull() %>%
psych::kurtosi()
tibble(x = rnorm(100000, sd = 20)) %>%
filter(x > -10 & x < 10) %>%
pull() %>%
psych::kurtosi()
tibble(x = rnorm(100000, sd = 20)) %>%
filter(x > -10 & x < 10) %>%
pull() %>% hist()
rnorm(10000, sd = .2) %>% psych::kurtosi()
rnorm(10000, sd = .2)
c(rnorm(10000, sd = .2), runif(10000)) %>% psych::kurtosi()
c(rnorm(10000, sd = .2), runif(10000)) %>% hist()
c(rnorm(10000, sd = .2), runif(100)) %>% hist()
c(rnorm(10000, sd = .2), runif(100, -10, 10)) %>% hist()
psych::kurtosi()
c(rnorm(10000, sd = .2), runif(100, -10, 10)) %>% #hist()
psych::kurtosi()
ggplot() +
geom_function(fun = dnorm, color = "black")
ggplot() +
geom_function(fun = dnorm, color = "black") +
xlim(-3, 3)
ggplot() +
geom_function(fun = dnorm, args = list(mean = 0, sd = .2), color = "black") +
geom_function(fun = dnorm, color = "gray") +
xlim(-3, 3)
ggplot() +
geom_function(fun = dnorm, args = list(mean = 0, sd = .4), color = "black") +
geom_function(fun = dnorm, color = "gray") +
xlim(-3, 3)
ggplot() +
geom_function(fun = dnorm, args = list(mean = 0, sd = 2.6), color = "black") +
geom_function(fun = dnorm, color = "gray") +
xlim(-3, 3)
ggplot() +
geom_function(fun = dnorm, args = list(mean = 0, sd = 2.1), color = "black") +
geom_function(fun = dnorm, color = "gray") +
xlim(-3, 3)
ggplot() +
geom_function(fun = dnorm, args = list(mean = 0, sd = 1.6), color = "black") +
geom_function(fun = dnorm, color = "gray") +
xlim(-3, 3)
set.seed(414)
tibble(x1 = rnorm(100),
x2 = 2.1 * x1 + .3 + rnorm(100)) %>%
ggplot(aes(x, y)) +
geom_point()
tibble(x1 = rnorm(100),
x2 = 2.1 * x1 + .3 + rnorm(100)) %>%
ggplot(aes(x1, x2)) +
geom_point()
tibble(x1 = rnorm(100),
x2 = 2.1 * x1 + .3 + rnorm(100)) %>%
mutate(relation = ifelse(x1 > mean(x1) & x2 > mean(x2) | x1 < mean(x1) & x2 < mean(x2), TRUE, FALSE)) -> cor_positive
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point()
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(xintercept = mean(x1)))
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2)))
set.seed(414)
tibble(x1 = rnorm(100),
x2 = 2.1 * x1 + .3 + rnorm(100)) %>%
mutate(relation = ifelse(x1 > mean(x1) & x2 > mean(x2) | x1 < mean(x1) & x2 < mean(x2), TRUE, FALSE)) -> cor_positive
tibble(x1 = rnorm(100),
x2 = -1.8 * x1 + .7 + rnorm(100)) %>%
mutate(relation = ifelse(x1 > mean(x1) & x2 > mean(x2) | x1 < mean(x1) & x2 < mean(x2), TRUE, FALSE))-> cor_negative
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2)))
cor_negative %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2)))
tibble(x1 = rnorm(100),
x2 = rnorm(100)) %>%
mutate(relation = ifelse(x1 > mean(x1) & x2 > mean(x2) | x1 < mean(x1) & x2 < mean(x2), TRUE, FALSE)) -> cor_none
cor_none %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2)))
cor_positive %>%
ggplot(aes(x1, x2)) +
geom_point()
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1)), linetype = "dashed") +
geom_hline(aes(yintercept = mean(x2)), linetype = "bashed")
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1)), linetype = "dashed") +
geom_hline(aes(yintercept = mean(x2)), linetype = "dashed")
cor_positive %>%
ggplot(aes(x1, x2)) +
geom_point() +
labs(x = TeX("$X_1$"), y = "$X_2$")
cor_positive %>%
ggplot(aes(x1, x2)) +
geom_point() +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_positive %>%
ggplot(aes(x1, x2)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1)), linetype = "dashed") +
geom_hline(aes(yintercept = mean(x2)), linetype = "dashed")+
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_negative %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_none %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_positive %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
guides(color = "none") +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_negative %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
guides(color = "none") +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
cor_none %>%
ggplot(aes(x1, x2, color = relation)) +
geom_point() +
geom_vline(aes(xintercept = mean(x1))) +
geom_hline(aes(yintercept = mean(x2))) +
scale_color_manual(values = c(`TRUE` = "blue3", `FALSE` = "red3")) +
guides(color = "none") +
labs(x = TeX("$X_1$"), y = TeX("$X_2$"))
